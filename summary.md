#良いコードとはなにか

### 良いコードの定義
1. 保守性が高い
2. すばやく効率的に動作する
3. 正確に動作する
4. 無駄な部分がない

### 良いコードの価値
* プロジェクトを強力に推し進める
シンプルで保守性が高く､安定したコードを書くことは品質や生産性を倍に高める｡

### 良い名前付け
一貫性があり､説明的である｡意味や意図を理解しやすい｡

### メソッド名
メソッドは処理を行うので､｢動詞｣+｢目的語｣になっていることが多い｡  
createXXX, makeXXXなど  
https://qiita.com/Ted-HM/items/7dde25dcffae4cdc7923  
http://d.hatena.ne.jp/r-west/20090510/1241962864  

インスタンスメソッドはオブジェクト名と組み合わせて呼ぶので､重複しないようにする｡  
dateFormatインスタンスのparseDateStringはDateが重複している｡  
dateFormat.parseDateString("2018-01-01");  
この場合はparseで十分理解できる｡  
dateFormat.parse("2018-01-01");  

### クラス名
良い名前が浮かばないときはクラスの役割を整理できていない｡  
複数の責務を担っていたり､役割が曖昧だったりする｡  
* クラスの名前付け=設計
クラス名の語彙は経験とともに高まる｡自分が知らない表現や概念は学ぶ必要がある｡

https://gihyo.jp/dev/serial/01/code/000204  
https://qiita.com/KeithYokoma/items/ee21fec6a3ebb5d1e9a8  
https://qiita.com/disc99/items/adff7ed5c497ac2674f4  

良い名前に対して意識を持って取り組んでいくことが大切｡  
知らないことは自分の中からは出てこないので､コードリーディングなどで知識を取り入れる必要がある｡  

### スコープ
変数やメソッド､クラスが見える範囲のこと｡
｢見える｣とは使えるということ｡
｢使える｣とは言い換えるとそれらに｢依存する｣ということ｡
依存が大きいと修正範囲が広くなり､保守性に影響を与える｡
スコープを小さくすることで､依存が小さく､保守性の高いプログラムになる｡

フィールド変数はprivateが基本｡アクセサメソッドを用いる｡基本であって時と場合による｡
https://www.kaitoy.xyz/2015/07/22/getters-setters-evil/  

クラスメソッド
クラスメソッドはフィールド変数にアクセスできない｡フィールド変数が影響を受けないのでスコープの範囲が狭くなる｡
フィールド変数にアクセス､オーバーライドする必要がないメソッドはクラスメソッドにしたほうが良い場合が多い｡

メソッドの引数の情報量
```
public function getEmployee(int $empId)
{
    return $empDao->findById($empId);
}
```

```
public function getEmployee(Employee $emp)
{
    return $empDao->findById($emp->getId());
}
```
前者はidを引数に渡しているが､後者はobjectを引数に渡している｡
必要なのは社員IDのみだが､メソッドを利用する側は社員オブジェクトの他の情報も必要なのかと考えてしまう｡
前者のほうが引数の情報量が少ないので､引数に対して依存度が少ない｡

ただし引数が多くなる場合は､引数をオブジェクトにしたほうが良い｡
目安として引数の数が5つを超えるメソッドは引数をオブジェクトに検討するほうが良い｡
https://twitter.com/xharaken/status/1065050626223042560

### コードの分割
~~~
private function createElement(Document $doc, string $nodeName, string $textContent, Element $parent)
{
    $node = doc->createElement(nodeName);
    $node->setTextContent($textContent);
    //外部の状態を変更
    $this->appendChild($node);
}
~~~

状態を変更する場合､外部に対して副作用があるメソッドになる｡  
副作用があるメソッドは何が変更されるのか意識して使う必要がある｡  
副作用があるメソッドはテストを難しくしたり､再利用しにくい｡  

* 状態を持つ処理をクラスに抽出して分割する
長い範囲で使用される状態を表すローカル変数があるとリファクタリングしにくい｡
状態を持つローカル変数は処理自体をクラスに抽出する｡そして状態を表すローカル変数をフィールド変数に移動させる｡

### コードの集約
1. 継承でまとめる
重複コードをメソッドとして抽出し､親クラスに移動してまとめる｡
* デメリット
    1. 親クラスが肥大化する｡
親クラスはすべての子クラスに必要な共通の振る舞いのみをもたせる｡
    2. 単一継承の制限
継承できる親クラスは1つのみ｡コードを広く共有するという意味では継承はそぐわない｡

2. ユーティリティクラスにまとめる
ユーティリティクラスのメソッドは基本的に状態を持たない処理をstaticなメソッドとして定義する｡
状態をもたせたり､DBへアクセスする必要があるときはサービス層にまとめる｡

3. サービス層にまとめる



















* リンク  
サーチコード  
https://searchcode.com/  
GitHubのコード検索  
https://github.com/search  
略語検索  
https://www.acronymfinder.com/  